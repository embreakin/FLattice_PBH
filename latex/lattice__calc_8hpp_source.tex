\hypertarget{lattice__calc_8hpp_source}{}\doxysection{lattice\+\_\+calc.\+hpp}
\label{lattice__calc_8hpp_source}\index{include/lattice\_include/lattice\_calc.hpp@{include/lattice\_include/lattice\_calc.hpp}}
\mbox{\hyperlink{lattice__calc_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//Doxygen}}
\DoxyCodeLine{10 \textcolor{comment}{}\textcolor{preprocessor}{\#ifndef \_LATTICECALC\_H\_}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define \_LATTICECALC\_H\_}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{comment}{//\#include <valarray>}}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{lattice__field_8hpp}{lattice\_field.hpp}}"{}}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{lattice__evol_8hpp}{lattice\_evol.hpp}}"{}}}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{class }\mbox{\hyperlink{class_energy}{Energy}}}
\DoxyCodeLine{20 \{}
\DoxyCodeLine{21     \textcolor{keyword}{protected}:}
\DoxyCodeLine{22     \textcolor{keywordtype}{double} \_variance;}
\DoxyCodeLine{23     \textcolor{keywordtype}{double} \_total\_average;}
\DoxyCodeLine{24     \textcolor{keywordtype}{double} \_potential\_average;}
\DoxyCodeLine{25     \textcolor{keywordtype}{double}  \_timederiv\_average;}
\DoxyCodeLine{26     \textcolor{keywordtype}{double} \_grad\_average;}
\DoxyCodeLine{27     \textcolor{keywordtype}{double} \_rad;}
\DoxyCodeLine{28     \textcolor{keywordtype}{double} \_value\_max;}
\DoxyCodeLine{29     }
\DoxyCodeLine{30     }
\DoxyCodeLine{31     \textcolor{keyword}{public}:}
\DoxyCodeLine{32     }
\DoxyCodeLine{33     \textcolor{keywordtype}{double} *value;}
\DoxyCodeLine{34     }
\DoxyCodeLine{35     }
\DoxyCodeLine{36     \mbox{\hyperlink{class_energy}{Energy}}():  \_total\_average(),\_potential\_average(),\_timederiv\_average(),\_grad\_average(),\_rad(),\_value\_max()}
\DoxyCodeLine{37     \{}
\DoxyCodeLine{38         }
\DoxyCodeLine{39         \textcolor{keywordflow}{switch}( dim )\{}
\DoxyCodeLine{40             \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{41                 value = \textcolor{keyword}{new} \textcolor{keywordtype}{double} [N]();\textcolor{comment}{//() is for initializing to zero}}
\DoxyCodeLine{42                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{43             \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{44                 value = \textcolor{keyword}{new} \textcolor{keywordtype}{double} [N*N]();}
\DoxyCodeLine{45                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{46             \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{47                 value = \textcolor{keyword}{new} \textcolor{keywordtype}{double} [N*N*N]();}
\DoxyCodeLine{48                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{49         \}}
\DoxyCodeLine{50     \}}
\DoxyCodeLine{51     }
\DoxyCodeLine{52     \mbox{\hyperlink{class_energy}{\string~Energy}}()\{}
\DoxyCodeLine{53         \textcolor{keyword}{delete} [] value;}
\DoxyCodeLine{54         }
\DoxyCodeLine{55     \}}
\DoxyCodeLine{56 }
\DoxyCodeLine{57         \textcolor{keywordtype}{double} total\_variance() \{ \textcolor{keywordflow}{return} sqrt(\_variance); \}}
\DoxyCodeLine{58         \textcolor{keywordtype}{double} total\_average   () \{ \textcolor{keywordflow}{return} \_total\_average*pw2(rescale\_B/rescale\_A); \}}
\DoxyCodeLine{59         \textcolor{keywordtype}{double} potential\_average () \{ \textcolor{keywordflow}{return} \_potential\_average*pw2(rescale\_B/rescale\_A);\}}
\DoxyCodeLine{60         \textcolor{keywordtype}{double} timederiv\_average () \{ \textcolor{keywordflow}{return} \_timederiv\_average*pw2(rescale\_B/rescale\_A);\}}
\DoxyCodeLine{61         \textcolor{keywordtype}{double} grad\_average () \{ \textcolor{keywordflow}{return} \_grad\_average*pw2(rescale\_B/rescale\_A);\}}
\DoxyCodeLine{62         \textcolor{keywordtype}{double} radiation () \{ \textcolor{keywordflow}{return} \_rad*pw2(rescale\_B/rescale\_A);\}}
\DoxyCodeLine{63         \textcolor{keywordtype}{double} energy\_max () \{\textcolor{keywordflow}{return} \_value\_max;\}}
\DoxyCodeLine{64     }
\DoxyCodeLine{65         \textcolor{keywordtype}{void} energy\_calc( \mbox{\hyperlink{class_field}{Field}}* field, \mbox{\hyperlink{class_leap_frog}{LeapFrog}}* leapfrog, \textcolor{keywordtype}{double}** f, \textcolor{keywordtype}{double}** df, \textcolor{keywordtype}{double}\& rad );}
\DoxyCodeLine{66         \textcolor{keywordtype}{double} gradient\_energy\_eachpoint( \textcolor{keywordtype}{double}** f ,\textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} idx );}
\DoxyCodeLine{67     }
\DoxyCodeLine{68 \textcolor{preprocessor}{       \#pragma omp declare simd}}
\DoxyCodeLine{69         \textcolor{keywordtype}{double} kinetic\_energy\_eachpoint( \textcolor{keywordtype}{double}** f , \textcolor{keywordtype}{double}** df, \textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} idx, \textcolor{keywordtype}{double} a = 1, \textcolor{keywordtype}{double} da = 0 )}
\DoxyCodeLine{70         \{   \textcolor{keywordflow}{return} pow(df[i][idx]*a -\/ f[i][idx]*da, 2.0)/(2*pow(a,2.0)); \}}
\DoxyCodeLine{71 }
\DoxyCodeLine{72 \};}
\DoxyCodeLine{73 }
\DoxyCodeLine{74 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
