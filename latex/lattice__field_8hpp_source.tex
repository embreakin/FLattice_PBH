\hypertarget{lattice__field_8hpp_source}{}\doxysection{lattice\+\_\+field.\+hpp}
\label{lattice__field_8hpp_source}\index{include/lattice\_include/lattice\_field.hpp@{include/lattice\_include/lattice\_field.hpp}}
\mbox{\hyperlink{lattice__field_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{//Doxygen}}
\DoxyCodeLine{10 \textcolor{comment}{}\textcolor{preprocessor}{\#ifndef \_LATTICEFIELD\_H\_}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#define \_LATTICEFIELD\_H\_}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{parameters_8hpp}{parameters.hpp}}"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{lattice__evol_8hpp}{lattice\_evol.hpp}}"{}}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{class }\mbox{\hyperlink{class_field}{Field}}}
\DoxyCodeLine{19 \{}
\DoxyCodeLine{20     \textcolor{keyword}{private}:}
\DoxyCodeLine{21         \textcolor{keywordtype}{double}* \_average;}
\DoxyCodeLine{22         \textcolor{keywordtype}{double}* \_variance;}
\DoxyCodeLine{23     }
\DoxyCodeLine{24         \textcolor{keywordtype}{double}* f\_MPl;}
\DoxyCodeLine{25         \textcolor{keywordtype}{int} fld;}
\DoxyCodeLine{26     }
\DoxyCodeLine{27         \textcolor{keywordtype}{int} J,K;}
\DoxyCodeLine{28         \textcolor{keywordtype}{int} m\_start;}
\DoxyCodeLine{29     }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#if  dim==1}}
\DoxyCodeLine{31     }
\DoxyCodeLine{32     }
\DoxyCodeLine{33     \textcolor{comment}{//Use 2D vector for power spectrum (fields, wave modes). Initialize by 0}}
\DoxyCodeLine{34     std::vector<std::vector<double>> PS = std::vector<std::vector<double>>(num\_fields, std::vector<double>(N/2+1, 0));}
\DoxyCodeLine{35     }
\DoxyCodeLine{36     \textcolor{comment}{//This 2D vector receives only the fluctuation of the input field}}
\DoxyCodeLine{37     std::vector<std::vector<double>> f\_fluc =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N, 0));}
\DoxyCodeLine{38     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform}}
\DoxyCodeLine{39     std::vector<std::vector<double>> f\_fluc\_k =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N, 0));}
\DoxyCodeLine{40     }
\DoxyCodeLine{41     \textcolor{comment}{//This 2D vector receives only the fluctuation of the input field derivative}}
\DoxyCodeLine{42     std::vector<std::vector<double>> df\_fluc =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N, 0));}
\DoxyCodeLine{43     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform}}
\DoxyCodeLine{44     std::vector<std::vector<double>> df\_fluc\_k =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N, 0));}
\DoxyCodeLine{45     }
\DoxyCodeLine{46     }
\DoxyCodeLine{47 \textcolor{preprocessor}{\#elif  dim==2}}
\DoxyCodeLine{48     }
\DoxyCodeLine{49     \textcolor{comment}{//Use 2D vector for power spectrum (fields, wave modes). Initialize by 0}}
\DoxyCodeLine{50     std::vector<std::vector<double>> PS = std::vector<std::vector<double>>(num\_fields, std::vector<double>(N/2+1, 0));}
\DoxyCodeLine{51     }
\DoxyCodeLine{52     \textcolor{comment}{//This 2D vector receives only the fluctuation of the input field}}
\DoxyCodeLine{53     std::vector<std::vector<double>> f\_fluc =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N, 0));}
\DoxyCodeLine{54     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform}}
\DoxyCodeLine{55     std::vector<std::vector<double>> f\_fluc\_k =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N, 0));}
\DoxyCodeLine{56     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform (Nyquist frequency corresponding to k (z-\/axis) = N/2)}}
\DoxyCodeLine{57     std::vector<std::vector<double>> f\_fluc\_k\_nyquist =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(2*N, 0));}
\DoxyCodeLine{58     }
\DoxyCodeLine{59     \textcolor{comment}{//This 2D vector receives only the fluctuation of the input field}}
\DoxyCodeLine{60     std::vector<std::vector<double>> df\_fluc =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N, 0));}
\DoxyCodeLine{61     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform}}
\DoxyCodeLine{62     std::vector<std::vector<double>> df\_fluc\_k =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N, 0));}
\DoxyCodeLine{63     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform (Nyquist frequency corresponding to k (z-\/axis) = N/2)}}
\DoxyCodeLine{64     std::vector<std::vector<double>> df\_fluc\_k\_nyquist =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(2*N, 0));}
\DoxyCodeLine{65     }
\DoxyCodeLine{66 \textcolor{preprocessor}{\#elif  dim==3}}
\DoxyCodeLine{67     }
\DoxyCodeLine{68     \textcolor{comment}{//Use 2D vector for power spectrum (fields, wave modes). Initialize by 0}}
\DoxyCodeLine{69     std::vector<std::vector<double>> PS = std::vector<std::vector<double>>(num\_fields, std::vector<double>(N/2+1, 0));}
\DoxyCodeLine{70     }
\DoxyCodeLine{71     \textcolor{comment}{//This 2D vector receives only the fluctuation of the input field}}
\DoxyCodeLine{72     std::vector<std::vector<double>> f\_fluc =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N*N, 0));}
\DoxyCodeLine{73     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform}}
\DoxyCodeLine{74     std::vector<std::vector<double>> f\_fluc\_k =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N*N, 0));}
\DoxyCodeLine{75     \textcolor{comment}{//This 3D vector receives the output of r2c Fourier transform (Nyquist frequency corresponding to l (z-\/axis) = N/2)}}
\DoxyCodeLine{76     std::vector<std::vector<std::vector<double>>> f\_fluc\_k\_nyquist =  std::vector<std::vector<std::vector<double>>>(num\_fields, std::vector<std::vector<double>>(N, std::vector<double>(2*N, 0)));}
\DoxyCodeLine{77     }
\DoxyCodeLine{78     \textcolor{comment}{//This 2D vector receives only the fluctuation of the input field}}
\DoxyCodeLine{79     std::vector<std::vector<double>> df\_fluc =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N*N, 0));}
\DoxyCodeLine{80     \textcolor{comment}{//This 2D vector receives the output of r2c Fourier transform}}
\DoxyCodeLine{81     std::vector<std::vector<double>> df\_fluc\_k =  std::vector<std::vector<double>>(num\_fields, std::vector<double>(N*N*N, 0));}
\DoxyCodeLine{82     \textcolor{comment}{//This 3D vector receives the output of r2c Fourier transform (Nyquist frequency corresponding to l (z-\/axis) = N/2)}}
\DoxyCodeLine{83     std::vector<std::vector<std::vector<double>>> df\_fluc\_k\_nyquist =  std::vector<std::vector<std::vector<double>>>(num\_fields, std::vector<std::vector<double>>(N, std::vector<double>(2*N, 0)));}
\DoxyCodeLine{84     }
\DoxyCodeLine{85     }
\DoxyCodeLine{86 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{87     }
\DoxyCodeLine{88     }
\DoxyCodeLine{89     \textcolor{keyword}{public}:}
\DoxyCodeLine{90     }
\DoxyCodeLine{91    }
\DoxyCodeLine{92     }
\DoxyCodeLine{93         \mbox{\hyperlink{class_field}{Field}} (): \_average(\textcolor{keyword}{new} \textcolor{keywordtype}{double} [num\_fields]()), \_variance(\textcolor{keyword}{new} \textcolor{keywordtype}{double} [num\_fields]()), f\_MPl(\textcolor{keyword}{new} \textcolor{keywordtype}{double} [num\_fields]())  \{}
\DoxyCodeLine{94             }
\DoxyCodeLine{95            }
\DoxyCodeLine{96 \textcolor{comment}{//            PS = new double** [num\_fields];}}
\DoxyCodeLine{97 \textcolor{comment}{//}}
\DoxyCodeLine{98 \textcolor{comment}{//            switch( dim )}}
\DoxyCodeLine{99 \textcolor{comment}{//            \{}}
\DoxyCodeLine{100 \textcolor{comment}{//                case 1:}}
\DoxyCodeLine{101 \textcolor{comment}{//                    PS[0] = new double* [num\_fields*(N/2+1)];}}
\DoxyCodeLine{102 \textcolor{comment}{//}}
\DoxyCodeLine{103 \textcolor{comment}{//                    for( int i = 0; i < num\_fields; ++i )}}
\DoxyCodeLine{104 \textcolor{comment}{//                    \{}}
\DoxyCodeLine{105 \textcolor{comment}{//                        PS[i] = PS[0] + i*(N/2+1);}}
\DoxyCodeLine{106 \textcolor{comment}{//}}
\DoxyCodeLine{107 \textcolor{comment}{//                        //Initialize all elements to 0 first. If we don't do this, a very small (or in some cases very large) value will be assigned instead and it can cause errors. Also, for some reason std::fill() doesn't work for some cases, so I've avoided using it. //}}
\DoxyCodeLine{108 \textcolor{comment}{//                        for( int j = 0; j < N; ++j )\{}}
\DoxyCodeLine{109 \textcolor{comment}{//                            int idx = j;}}
\DoxyCodeLine{110 \textcolor{comment}{//}}
\DoxyCodeLine{111 \textcolor{comment}{//                            PS[i][idx] = 0;}}
\DoxyCodeLine{112 \textcolor{comment}{//                        \}}}
\DoxyCodeLine{113 \textcolor{comment}{//}}
\DoxyCodeLine{114 \textcolor{comment}{//                    \}}}
\DoxyCodeLine{115 \textcolor{comment}{//}}
\DoxyCodeLine{116 \textcolor{comment}{//                    break;}}
\DoxyCodeLine{117 \textcolor{comment}{//                case 2:}}
\DoxyCodeLine{118 \textcolor{comment}{//                    PS[0] = new double [num\_fields*N*N];}}
\DoxyCodeLine{119 \textcolor{comment}{//}}
\DoxyCodeLine{120 \textcolor{comment}{//                    for( int i = 0; i < num\_fields; ++i )}}
\DoxyCodeLine{121 \textcolor{comment}{//                    \{}}
\DoxyCodeLine{122 \textcolor{comment}{//                        PS[i] = PS[0] + i*N*N;}}
\DoxyCodeLine{123 \textcolor{comment}{//}}
\DoxyCodeLine{124 \textcolor{comment}{//                        for( int j = 0; j < N; ++j )\{}}
\DoxyCodeLine{125 \textcolor{comment}{//                            for( int k = 0; k < N; ++k )\{}}
\DoxyCodeLine{126 \textcolor{comment}{//                                int idx = j*N + k;}}
\DoxyCodeLine{127 \textcolor{comment}{//                                PS[i][idx] = 0;}}
\DoxyCodeLine{128 \textcolor{comment}{//                            \}}}
\DoxyCodeLine{129 \textcolor{comment}{//                        \}}}
\DoxyCodeLine{130 \textcolor{comment}{//}}
\DoxyCodeLine{131 \textcolor{comment}{//                    \}}}
\DoxyCodeLine{132 \textcolor{comment}{//                    break;}}
\DoxyCodeLine{133 \textcolor{comment}{//                case 3:}}
\DoxyCodeLine{134 \textcolor{comment}{//                    PS[0] = new double [num\_fields*N*N*N];}}
\DoxyCodeLine{135 \textcolor{comment}{//}}
\DoxyCodeLine{136 \textcolor{comment}{//                    for( int i = 0; i < num\_fields; ++i )}}
\DoxyCodeLine{137 \textcolor{comment}{//                    \{}}
\DoxyCodeLine{138 \textcolor{comment}{//                        PS[i] = PS[0] + i*N*N*N;}}
\DoxyCodeLine{139 \textcolor{comment}{//}}
\DoxyCodeLine{140 \textcolor{comment}{//                        for( int j = 0; j < N; ++j )\{}}
\DoxyCodeLine{141 \textcolor{comment}{//                            for( int k = 0; k < N; ++k )\{}}
\DoxyCodeLine{142 \textcolor{comment}{//                                for( int l = 0; l < N; ++l )\{}}
\DoxyCodeLine{143 \textcolor{comment}{//                                    int idx = (j*N + k)*N + l;}}
\DoxyCodeLine{144 \textcolor{comment}{//                                    PS[i][idx] = 0;}}
\DoxyCodeLine{145 \textcolor{comment}{//                                \}}}
\DoxyCodeLine{146 \textcolor{comment}{//                            \}}}
\DoxyCodeLine{147 \textcolor{comment}{//                        \}}}
\DoxyCodeLine{148 \textcolor{comment}{//                    \}}}
\DoxyCodeLine{149 \textcolor{comment}{//                    break;}}
\DoxyCodeLine{150 \textcolor{comment}{//                default:}}
\DoxyCodeLine{151 \textcolor{comment}{//                    std::cout << "{}Error: Simulation dimension must be 1, 2, or 3"{} << std::endl;}}
\DoxyCodeLine{152 \textcolor{comment}{//                    exit(1);}}
\DoxyCodeLine{153 \textcolor{comment}{//            \}}}
\DoxyCodeLine{154 \textcolor{comment}{//}}
\DoxyCodeLine{155             }
\DoxyCodeLine{156         \}}
\DoxyCodeLine{157     }
\DoxyCodeLine{158         \mbox{\hyperlink{class_field}{\string~Field}} () \{}
\DoxyCodeLine{159             \textcolor{keyword}{delete} [] \_average;}
\DoxyCodeLine{160             \textcolor{keyword}{delete} [] \_variance;}
\DoxyCodeLine{161             \textcolor{keyword}{delete} [] f\_MPl;}
\DoxyCodeLine{162         \}}
\DoxyCodeLine{163     }
\DoxyCodeLine{164     \textcolor{comment}{//void zeromode\_initialize();}}
\DoxyCodeLine{165         \textcolor{keywordtype}{double} laplacian        ( \textcolor{keywordtype}{double}* f, \textcolor{keywordtype}{int} j, \textcolor{keywordtype}{int} k = 0, \textcolor{keywordtype}{int} l = 0 ); \textcolor{comment}{//You can omit k and l if they are zero}}
\DoxyCodeLine{166         \textcolor{keywordtype}{double} gradient\_energy\_eachpoint( \textcolor{keywordtype}{double}** f ,\textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} idx );}
\DoxyCodeLine{167         \textcolor{keywordtype}{double} gradient\_energy  ( \textcolor{keywordtype}{double}* f ) ;}
\DoxyCodeLine{168         \textcolor{keywordtype}{double} potential\_energy ( \textcolor{keywordtype}{double}** f, \textcolor{keywordtype}{double} a );}
\DoxyCodeLine{169         \textcolor{keywordtype}{double} average  ( \textcolor{keywordtype}{double}* f, \textcolor{keywordtype}{int} i );}
\DoxyCodeLine{170         \textcolor{keywordtype}{double} variance ( \textcolor{keywordtype}{double}* f, \textcolor{keywordtype}{int} i );}
\DoxyCodeLine{171         \textcolor{keywordtype}{double} V\_lattice  ( \textcolor{keywordtype}{double}** f, \textcolor{keywordtype}{int} idx, \textcolor{keywordtype}{double} a = 1 );}
\DoxyCodeLine{172         \textcolor{keywordtype}{double} dV\_lattice ( \textcolor{keywordtype}{double}** f, \textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} idx, \textcolor{keywordtype}{double} a = 1);}
\DoxyCodeLine{173         \textcolor{keywordtype}{double} ddV\_lattice ( \textcolor{keywordtype}{double}** f, \textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} idx, \textcolor{keywordtype}{double} a = 1 );}
\DoxyCodeLine{174         \textcolor{keywordtype}{void} effective\_mass(\textcolor{keywordtype}{double} mass\_sq[], \textcolor{keywordtype}{double} *field\_values);}
\DoxyCodeLine{175         \textcolor{keywordtype}{double} power\_spectrum( \textcolor{keywordtype}{double}** f, \textcolor{keywordtype}{int} i, \textcolor{keywordtype}{int} j);}
\DoxyCodeLine{176     \textcolor{keywordtype}{void} finalize(\textcolor{keywordtype}{double}** f, \textcolor{keywordtype}{double}** df, \mbox{\hyperlink{class_leap_frog}{LeapFrog}}* leapfrog, \textcolor{keywordtype}{double} radiation\_pr, \textcolor{keywordtype}{double}** lattice\_var );}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \};}
\DoxyCodeLine{179 }
\DoxyCodeLine{180 }
\DoxyCodeLine{181 }
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
